/*! angular-timezones - v0.3.8 - 2014-02-26 */!function(a){var b=a.angular,c=a.timezoneJS,d=a.jstz,e=function(a){var b,c=new Date;for(b in a)c[b]=a[b];return c},f=b.module("Timezones",[]);f.config(function(){c.fromLocalString=function(a,b){var d,f,g=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(a),h=[1,4,5,6,7,10,11];for(d=0;f=h[d];++d)g[f]=+g[f]||0;return g[2]=(+g[2]||1)-1,g[3]=+g[3]||1,e(new c.Date(g[1],g[2],g[3],g[4],g[5],g[6],g[7],b))}}),f.constant("$timezones.definitions.location","/tz/data"),f.run(["$timezones.definitions.location",function(a){c.timezone.zoneFileBasePath=a,c.timezone.init({async:!1})}]),f.factory("$timezones",["$log","$http","$timezones.definitions.location",function(a,f,g){var h=function(d,e){var f,g;if("number"==typeof e&&(e=new Date(e)),!b.isDate(e))throw a.error("DateObjectExpected. Expected a Date object; got: "+typeof e+" of "+e),{name:"DateObjectExpected",message:'Expected a Date object; got "'+e+'".'};return e=new c.Date(e,d),f=e.getTimezone(),g={name:f,abbreviation:e.getTimezoneAbbreviation(),offset:e.getTimezoneOffset(),region:f.split("/")[0],locality:f.split("/")[1].replace("_"," ")}};return{align:function(d,f,g){var h;if(!b.isDate(d))throw h="Expected a Date object; got: "+typeof reference+" of "+d,a.error(h),{name:"DateObjectExpected",message:h};if(b.isObject(f)&&f.name)return e(new c.Date(d,f.name));if(b.isString(f))return e(new c.Date(d,f));if(!0===g)return d;throw h="The timezone argument must either be an Olson name (e.g., America/New_York), or a timezone object (produced by the resolve function) bearing an Olson name on the name property.",a.error(h),new Error(h)},resolve:h,getLocal:function(){var b,c,e;if("undefined"==typeof d||"function"!=typeof d.determine)throw b="The jsTimezoneDetect library, available at https://bitbucket.org/pellepim/jstimezonedetect, is required to detect the local timezone.",a.error(b),{name:"JSTZLibraryMissing",message:b};return c=d.determine().name(),e=new Date,h(c,e)},toUTC:function(a,c){var d,e,f=b.isDate(a)?a:new Date(a);return d=f.getUTCFullYear()+"-"+("00"+(f.getUTCMonth()+1)).substr(-2,2)+"-"+("00"+f.getUTCDate()).substr(-2,2)+"T"+("00"+f.getUTCHours()).substr(-2,2)+":"+("00"+f.getUTCMinutes()).substr(-2,2)+":"+("00"+f.getUTCSeconds()).substr(-2,2)+".000Z",e=this.align(new Date(d),c),new Date(e.getTime()+6e4*e.getTimezoneOffset())},getZoneList:function(b){var c,d=[];localStorage.zones?b.$emit("zonesReady"):f({method:"GET",url:g+"/zone.tab"}).success(function(a){var e,f,g=a.match(/[^\r\n]+/g);for(e=0;e<g.length;e++)/^#/.test(g[e])||(f=g[e].split(/\s+/),d.push(f[2]));for(c=d.sort(),d=[],e=0;e<c.length;e++)d.push({name:c[e]});localStorage.zones=JSON.stringify(d),b.$emit("zonesReady")}).error(function(){a.error("Failed to load "+g+"/zone.tab")})}}}]),f.filter("tzAlign",["$timezones",function(a){return function(c,d){if(!(b.isDate(c)||b.isNumber(c)||b.isString(c))||!b.isString(d)&&!b.isObject(d))return c;var e,f,g=c;return b.isNumber(c)?g=new Date(c):b.isString(c)&&(f=parseInt(c),b.isNumber(f)||(f=Date.parse(c)),g=new Date(f)),!b.isDate(g)||isNaN(g.getTime())?c:(e=a.align(g,d,!0),isNaN(e.getTime())?c:e)}}])}(this);